@page "/todo"
@using OmMediaWorkManagement.Web.Components.Models
@using OmMediaWorkManagement.Web.Components.Services 
@inject NavigationManager Navigation
<style>
    .rz-grid-table {
        width: unset;
    }
</style>

<RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="10px" class="mt-2 mb-4">
    <RadzenButton ButtonStyle="ButtonStyle.Success" Icon="add_circle_outline" Text="Add New Client" onclick="@InsertRow()" />
</RadzenStack>

<RadzenDataGrid @ref="clientsGrid" AllowPaging="true" PageSize="10" AllowSorting="true" Data="@clients" TItem="OmClient" EditMode="DataGridEditMode.Single" RowUpdate="@OnUpdateRow" RowCreate="@OnCreateRow">
    <Columns>
        <RadzenDataGridColumn TItem="OmClient" Property="Id" Title="ID" Width="70px" />
        <RadzenDataGridColumn TItem="OmClient" Property="Name" Title="Name" Width="150px">
            <EditTemplate Context="client">
                <RadzenTextBox @bind-Value="client.Name" Style="width:100%; display: block" Name="Name" aria-label="Enter name" />
                <RadzenRequiredValidator Text="Name is required" Component="Name" Popup="true" />
            </EditTemplate>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn TItem="OmClient" Property="CompanyName" Title="Company Name" Width="200px">
            <EditTemplate Context="client">
                <RadzenTextBox @bind-Value="client.CompanyName" Style="width:100%; display: block" Name="CompanyName" aria-label="Enter company name" />
                <RadzenRequiredValidator Text="Company Name is required" Component="CompanyName" Popup="true" />
            </EditTemplate>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn TItem="OmClient" Property="MobileNumber" Title="Mobile Number" Width="150px">
            <EditTemplate Context="client">
                <RadzenTextBox @bind-Value="client.MobileNumber" Style="width:100%; display: block" Name="MobileNumber" aria-label="Enter mobile number" />
                <RadzenRequiredValidator Text="Mobile Number is required" Component="MobileNumber" Popup="true" />
            </EditTemplate>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn TItem="OmClient" Property="Email" Title="Email" Width="200px">
            <EditTemplate Context="client">
                <RadzenTextBox @bind-Value="client.Email" Style="width:100%; display: block" Name="Email" aria-label="Enter email" />
                <RadzenRequiredValidator Text="Email is required" Component="Email" Popup="true" />
            </EditTemplate>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn TItem="OmClient" Property="CreatedAt" Title="Created At" Width="150px">
            <Template Context="client">
                @String.Format("{0:yyyy-MM-dd}", client.CreatedAt)
            </Template>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn TItem="OmClient" Property="IsDeleted" Title="Deleted" Width="100px">
            <Template Context="client">
                @(client.IsDeleted ? "Yes" : "No")
            </Template>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn Context="client" Filterable="false" Sortable="false" TextAlign="TextAlign.Right" Width="100px">
            <Template Context="client">
                <RadzenButton Icon="edit" ButtonStyle="ButtonStyle.Light" Variant="Variant.Flat" Size="ButtonSize.Medium" Click="@(args => EditRow(client))" @onclick:stopPropagation="true">
                </RadzenButton>
                <RadzenButton ButtonStyle="ButtonStyle.Danger" Icon="delete" Variant="Variant.Flat" Shade="Shade.Lighter" Size="ButtonSize.Medium" class="my-1 ms-1" Click="@(args => DeleteRow(client))" @onclick:stopPropagation="true">
                </RadzenButton>
            </Template>
            <EditTemplate Context="client">
                <RadzenButton Icon="check" ButtonStyle="ButtonStyle.Success" Variant="Variant.Flat" Size="ButtonSize.Medium" Click="@((args) => SaveRow(client))" aria-label="Save">
                </RadzenButton>
                <RadzenButton Icon="close" ButtonStyle="ButtonStyle.Light" Variant="Variant.Flat" Size="ButtonSize.Medium" class="my-1 ms-1" Click="@((args) => CancelEdit(client))" aria-label="Cancel">
                </RadzenButton>
            </EditTemplate>
        </RadzenDataGridColumn>
    </Columns>
</RadzenDataGrid>